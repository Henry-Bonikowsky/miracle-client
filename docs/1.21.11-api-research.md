# Minecraft 1.21.9+ Screen Input API Changes Research Report

**Date:** January 2, 2026
**Purpose:** Document breaking API changes for Screen input handling in Minecraft 1.21.9, 1.21.10, and 1.21.11

---

## Executive Summary

Starting with Minecraft 1.21.9 (The Copper Age, released September 30, 2025), Mojang introduced significant breaking changes to the GUI input handling system. The most critical change is the consolidation of input parameters into context objects (`KeyInput`, `CharInput`, `Click`), replacing the traditional primitive parameter signatures.

---

## Key API Changes

### 1. Screen Input Method Signature Changes

#### Old API (Pre-1.21.9)
```java
// Mouse clicked - OLD
public boolean mouseClicked(double mouseX, double mouseY, int button)

// Mouse dragged - OLD
public boolean mouseDragged(double mouseX, double mouseY, int button, double deltaX, double deltaY)

// Key pressed - OLD
public boolean keyPressed(int keyCode, int scanCode, int modifiers)

// Char typed - OLD
public boolean charTyped(char chr, int modifiers)
```

#### New API (1.21.9+)
```java
// Mouse clicked - NEW
public boolean mouseClicked(Click click, boolean down)

// Mouse dragged - NEW
public boolean mouseDragged(Click click, double deltaX, double deltaY)

// Key pressed - NEW
public boolean keyPressed(KeyInput input)

// Char typed - NEW
public boolean charTyped(CharInput input)
```

### 2. New Context Classes

#### `KeyInput` Class
- Consolidates: `keyCode`, `scanCode`, `modifiers`
- Location: `net.minecraft.client.input.KeyInput` (Yarn mappings)
- Key codes identified by GLFW class constants
- Modifiers are GLFW bitfields describing held modifier keys

#### `CharInput` Class
- Consolidates: character, modifiers
- Used for text input handling

#### `Click` Class
- Consolidates: mouse position, button information
- Location: `net.minecraft.client.gui.Click` (Yarn mappings)
- Used for mouse click and drag events

### 3. ParentElement Interface Changes

The `ParentElement` interface now defines these methods with new signatures:
- `mouseClicked(Click, boolean)`
- `mouseDragged(Click, double, double)`
- `mouseReleased(Click)`
- `keyPressed(KeyInput)`
- `keyReleased(KeyInput)`
- `charTyped(CharInput)`

---

## Fabric API Specific Changes

### Screen Events API
- `afterMouseX` style events now take and return a boolean
- Returning `true` prevents further vanilla handling (event consumption)
- Most parameters consolidated into `KeyInput` context object

### KeyBinding Category Changes
- Each category may only be registered once
- Registering duplicate category IDs throws an exception
- Mod-provided categories sorted alphabetically by namespace, then path
- On versions older than 1.21.9: use translation key string (e.g., `"category.examplemod.test"`)
- On 1.21.9+: use `KeyBinding.Category` objects

---

## Version Timeline

| Version | Release Date | Key Changes |
|---------|-------------|-------------|
| 1.21.8 | June 2025 | Last version with old input API |
| 1.21.9 | Sept 30, 2025 | Input API overhaul, KeyInput/Click introduced |
| 1.21.10 | Oct 7, 2025 | Minor hotfix, compatible with 1.21.9 |
| 1.21.11 | Dec 5, 2025 | Last obfuscated version, same input API as 1.21.9 |

---

## Migration Strategy for Miracle Client

### Recommended Approach
Use Stonecutter version conditionals to maintain compatibility:

```java
/*? if MC_1_21_11 {*/
@Override
public boolean mouseClicked(Click click, boolean down) {
    if (!down) return super.mouseClicked(click, down);
    // Get mouse position from client
    double mouseX = client.mouse.getX() * width / client.getWindow().getWidth();
    double mouseY = client.mouse.getY() * height / client.getWindow().getHeight();
    return handleMouseClick(mouseX, mouseY);
}
/*?} else {*/
/*@Override
public boolean mouseClicked(double mouseX, double mouseY, int button) {
    return handleMouseClick(mouseX, mouseY) || super.mouseClicked(mouseX, mouseY, button);
}*/
/*?}*/

/*? if MC_1_21_11 {*/
@Override
public boolean keyPressed(KeyInput input) {
    int keyCode = input.keyCode(); // or input.key().getCode() - needs verification
    if (keyCode == 344 || keyCode == 256) {
        close();
        return true;
    }
    return super.keyPressed(input);
}
/*?} else {*/
/*@Override
public boolean keyPressed(int keyCode, int scanCode, int modifiers) {
    if (keyCode == 344 || keyCode == 256) {
        close();
        return true;
    }
    return super.keyPressed(keyCode, scanCode, modifiers);
}*/
/*?}*/
```

### Import Requirements
```java
/*? if MC_1_21_11 {*/
import net.minecraft.client.gui.Click;
import net.minecraft.client.input.KeyInput;
import net.minecraft.client.input.CharInput;
/*?}*/
```

---

## Additional Breaking Changes in 1.21.9

1. **Entity Method Rename**: `Entity#getWorld` -> `Entity#getEntityWorld`
2. **World Render Events**: Removed (use mixins as workaround)
3. **Resource Loader API**: Major rework with `ResourceReloader` focus
4. **Mac OS Detection**: `MinecraftClient.IS_SYSTEM_MAC` -> `SystemKeycodes.IS_MAC_OS`

---

## Development Requirements

| Version | Loom Version | Loader Version |
|---------|-------------|----------------|
| 1.21.9 | 1.11+ | 0.17.2+ |
| 1.21.11 | 1.14+ | 0.18.1+ |

---

## Important Notes

### Yarn Mappings Future
- 1.21.11 is the last obfuscated Minecraft version
- Post-1.21.11 versions will not be obfuscated
- Yarn and Intermediary updates will stop after 1.21.11
- **Recommendation**: Begin migrating to Mojang Mappings

### Verified Class Paths (Decompiled from MC 1.21.11)

**`net.minecraft.client.gui.Click`** (Record)
```java
public final class Click extends Record implements AbstractInput {
    private final double x;
    private final double y;
    private final MouseInput buttonInfo;

    // Accessors
    public double x();
    public double y();
    public int button();
    public int modifiers();
    public int getKeycode();
    public MouseInput buttonInfo();
}
```

**`net.minecraft.client.input.KeyInput`** (Record)
```java
public final class KeyInput extends Record implements AbstractInput {
    private final int key;
    private final int scancode;
    private final int modifiers;

    // Accessors
    public int key();       // Use this for key code
    public int scancode();
    public int modifiers();
    public int getKeycode();
}
```

**`net.minecraft.client.input.CharInput`** (Record)
```java
public final class CharInput extends Record {
    private final int codepoint;
    private final int modifiers;

    // Accessors
    public int codepoint();
    public int modifiers();
    public String asString();
    public boolean isValidChar();
}
```

---

## Sources

### Official Documentation
1. [Fabric for Minecraft 1.21.9 & 1.21.10](https://fabricmc.net/2025/09/23/1219.html)
2. [Fabric for Minecraft 1.21.11](https://fabricmc.net/2025/12/05/12111.html)
3. [Minecraft Java Edition 1.21.9](https://www.minecraft.net/en-us/article/minecraft-java-edition-1-21-9)
4. [Java Edition 1.21.9 - Minecraft Wiki](https://minecraft.wiki/w/Java_Edition_1.21.9)
5. [Minecraft 1.21.11 Changelog - MCC Gadgets](https://www.mcc-gadgets.com/java/changelog/1.21.11)
6. [Removing obfuscation in Java Edition](https://www.minecraft.net/en-us/article/removing-obfuscation-in-java-edition)

### Fabric API Documentation
7. [Custom Screens - Fabric Docs](https://docs.fabricmc.net/develop/rendering/gui/custom-screens)
8. [Custom Widgets - Fabric Docs](https://docs.fabricmc.net/develop/rendering/gui/custom-widgets)
9. [Custom Keybinds - Fabric Wiki](https://wiki.fabricmc.net/tutorial:keybinds)
10. [ScreenMouseEvents - Fabric API](https://maven.fabricmc.net/docs/fabric-api-0.34.8+1.17/net/fabricmc/fabric/api/client/screen/v1/ScreenMouseEvents.html)
11. [ScreenEvents - Fabric API 0.97.9+1.21](https://maven.fabricmc.net/docs/fabric-api-0.97.9+1.21/net/fabricmc/fabric/api/client/screen/v1/ScreenEvents.html)
12. [Fabric API Modrinth](https://modrinth.com/mod/fabric-api/versions)
13. [Fabric API 0.140.2+1.21.11](https://modrinth.com/mod/fabric-api/version/0.140.2+1.21.11)

### Yarn Mappings
14. [FabricMC/yarn GitHub](https://github.com/FabricMC/yarn)
15. [Screen - yarn 1.21.9 API](https://maven.fabricmc.net/docs/yarn-1.21.9+build.1/net/minecraft/client/gui/screen/Screen.html)
16. [SleepingChatScreen - yarn 1.21.9](https://maven.fabricmc.net/docs/yarn-1.21.9+build.1/net/minecraft/client/gui/screen/SleepingChatScreen.html)
17. [ParentElement - yarn API](https://maven.fabricmc.net/docs/yarn-21w05b+build.11/net/minecraft/client/gui/ParentElement.html)
18. [Input - yarn 1.21.2](https://maven.fabricmc.net/docs/yarn-1.21.2+build.1/net/minecraft/client/input/Input.html)
19. [Mappings Migration - Fabric Wiki](https://wiki.fabricmc.net/tutorial:migratemappings)
20. [Migrating Mappings - Fabric Docs](https://docs.fabricmc.net/develop/migrating-mappings/)

### NeoForge/Forge Documentation
21. [Screens - NeoForge Docs](https://docs.neoforged.net/docs/1.21.1/gui/screens/)
22. [Key Mappings - NeoForge Docs](https://docs.neoforged.net/docs/1.20.4/misc/keymappings/)
23. [Screens - Forge Documentation](https://docs.minecraftforge.net/en/1.19.x/gui/screens/)

### GitHub Resources
24. [Fabric API Releases](https://github.com/FabricMC/fabric-api/releases)
25. [User Input Events v1 PR #1272](https://github.com/FabricMC/fabric/pull/1272)
26. [Fabric API README 1.21.11](https://github.com/FabricMC/fabric-api/blob/1.21.11/README.md)

### Deobfuscation Tools
27. [McDeob - GitHub](https://github.com/ShaneBeeStudios/McDeob)
28. [MC-Remapper - GitHub](https://github.com/HeartPattern/MC-Remapper)
29. [MCMapper - GitHub](https://github.com/Porama6400/MCMapper)

### Additional Resources
30. [GLFW Keyboard Key Tokens](https://www.glfw.org/docs/latest/group__keys.html)
31. [Fabric Events Documentation](https://docs.fabricmc.net/develop/events)
32. [Creating a Screen - Fabric Wiki](https://fabricmc.net/wiki/tutorial:screen)

---

## Next Steps for Miracle Client

1. **Verify Class Paths**: Decompile MC 1.21.11 with Mojang mappings to confirm exact package paths for Click, KeyInput, CharInput
2. **Implement Conditionals**: Add Stonecutter conditionals for MC_1.21_11 input handling
3. **Test Thoroughly**: Ensure menu works on all four build targets (1.21.4, 1.21.5, 1.21.8, 1.21.11)
4. **Plan Mojang Mappings Migration**: Begin planning transition away from Yarn before post-1.21.11 versions

---

*Report compiled from 32 sources on January 2, 2026*
